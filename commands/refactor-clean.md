---
description: 安全识别并删除死代码，带测试验证。
---

# /refactor-clean 命令

安全识别并删除死代码，带测试验证：

## 执行步骤

1. 运行死代码分析工具：
   - `knip`：查找未使用的导出和文件
   - `depcheck`：查找未使用的依赖
   - `ts-prune`：查找未使用的 TypeScript 导出

2. 在 `.reports/dead-code-analysis.md` 中生成综合报告

3. 按严重性分类发现：
   - **安全**：测试文件、未使用的工具
   - **谨慎**：API 路由、组件
   - **危险**：配置文件、主入口点

4. 仅建议安全删除

5. 每次删除前：
   - 运行完整测试套件
   - 验证测试通过
   - 应用更改
   - 重新运行测试
   - 如果测试失败则回滚

6. 显示清理项目摘要

## 安全原则

**永不删除代码而不先运行测试！**

### 应该删除
- 未使用的导入
- 死代码分支
- 重复的组件
- 未使用的依赖

### 谨慎删除
- 公共 API
- 动态导入的模块
- 配置文件

### 永不删除
- 主入口点
- 认证代码
- 数据库连接
