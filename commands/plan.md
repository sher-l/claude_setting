---
description: 重述需求、评估风险并创建逐步实现计划。在触碰任何代码前等待用户确认。
---

# /plan 命令

此命令调用 **planner** 代理，在编写任何代码之前创建全面的实现计划。

## 这个命令做什么

1. **重述需求** - 澄清需要构建什么
2. **识别风险** - 揭示潜在问题和阻碍
3. **创建步骤计划** - 将实现分解为阶段
4. **等待确认** - 必须收到用户批准才能继续

## 何时使用

使用 `/plan` 当：
- 开始新功能
- 进行重大架构变更
- 复杂重构
- 多个文件/组件将受影响
- 需求不清晰或模糊

## 如何工作

planner代理将：

1. **分析请求**并清晰重述需求
2. **分解为阶段**，有具体可操作的步骤
3. **识别依赖**组件之间
4. **评估风险**和潜在阻碍
5. **估算复杂度**（高/中/低）
6. **展示计划**并等待你的明确确认

## 示例用法

```
用户: /plan 我需要添加实时通知功能

代理 (planner):
# 实现计划：实时通知

## 需求重述
- 当用户关注的市场解决时发送通知
- 支持多种通知渠道（应用内、邮件）
- 确保通知可靠送达

## 实现阶段

### 阶段1：数据库模式
- 添加notifications表
- 添加用户通知偏好设置表
- 创建索引优化性能

### 阶段2：通知服务
- 创建通知服务
- 实现通知队列
- 添加重试逻辑

### 阶段3：集成点
- 挂钩到市场解决逻辑
- 查询所有相关用户
- 排队通知

### 阶段4：前端组件
- 创建通知铃铛组件
- 添加通知列表模态框

## 依赖
- Redis（用于队列）
- 邮件服务

## 风险
- 高：邮件送达能力
- 中：性能（1000+用户）
- 中：通知垃圾信息

## 预估复杂度：中

**等待确认**：是否继续此计划？(是/否/修改)
```

## 重要说明

**关键**：planner代理在你明确确认计划之前**不会**编写任何代码。

如果你想修改，回复：
- "修改：[你的修改]"
- "不同方法：[替代方案]"
- "跳过阶段2先做阶段3"

## 与其他命令集成

规划后：
- 使用 `/tdd` 进行测试驱动开发
- 使用 `/build-fix` 如果出现构建错误
- 使用 `/code-review` 审查完成的实现
